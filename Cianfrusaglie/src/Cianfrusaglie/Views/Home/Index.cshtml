@functions
{


    public IEnumerable< Announce > GetAnnounce() {
        foreach( var announce in ViewData[ "listAnnounces" ] as List< Announce > ) {
            yield return announce;
        }
    }

    public User GetAutore( string AuthorId ) {
        foreach( var user in ViewData[ "listUsers" ] as List< User > ) {
            if( user.Id == AuthorId )
                return user;
        }
        return null;
    }

    public string GetImages( int AnnounceId ) {
        foreach( var imm in ViewData[ "listImages" ] as List< ImageUrl > ) {
            if( imm.AnnounceId == AnnounceId )
                return imm.Url;
        }
        return null;
    }

}

<div id="wrap" >


    @if( TempData[ "announceCreated" ] != null ) {
        <div class="alert alert-success alert-dismissible" role="alert" >
            <button aria-label="Close" class="close" data-dismiss="alert" type="button" >
                <span aria-hidden="true">&times;</span></button>
            <strong>Ottimo!</strong> @TempData[ "announceCreated" ]
        </div>
    }
    <div class="container-fluid" id="containerPrincipale" >
        <div class="carousel slide" data-ride="carousel" id="homeCarousel" >
            <ol class="carousel-indicators" style="z-index: 1" >
                <li class="active" data-slide-to="0" data-target="#homeCarousel" ></li>
                <li data-slide-to="1" data-target="#homeCarousel" ></li>
                <li data-slide-to="2" data-target="#homeCarousel" ></li>
                <li data-slide-to="3" data-target="#homeCarousel" ></li>
                <li data-slide-to="4" data-target="#homeCarousel" ></li>
            </ol>
            <div align="center" class="carousel-inner" role="listbox" >
                <div class="item active" >
                    <img src="/images/mercatino-delle-pulci.jpg" />
                </div>
                <div class="item" >
                    <img src="/images/rumenta.jpg" />
                </div>
            </div>
            <a class="left carousel-control" data-slide="prev" href="#homeCarousel" role="button" >
                <span class="glyphicon glyphicon-chevron-left"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="right carousel-control" data-slide="next" href="#homeCarousel" role="button" >
                <span class="glyphicon glyphicon-chevron-right"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>

        <div id="linkHome" >
            <form class="form-inline" role="form" >
                <div class="form-group" id="linkRegala" >
                    @if( !User.Identity.IsAuthenticated ) {
                        <a class="btn btn-warning btn-lg btn-round" data-target="#myWindow" data-toggle="modal" href="#" role="button" >
                            <span class="glyphicon glyphicon-gift"></span></a>
                    } else {
                        <a class="btn btn-warning btn-lg btn-round" href="~/Announces/Create" role="button" >
                            <span class="glyphicon glyphicon-gift"></span></a>
                    }
                    <br /><br /><label>REGALA</label>
                </div>
                <div class="form-group" id="linkVendi" >
                    @if( !User.Identity.IsAuthenticated ) {
                        <a class="btn btn-warning btn-lg btn-round" data-target="#myWindow" data-toggle="modal" href="#" role="button" >
                            <span class="glyphicon glyphicon-eur"></span></a>
                    } else {
                        <a class="btn btn-warning btn-lg btn-round" href="#" role="button" >
                            <span class="glyphicon glyphicon-eur"></span></a>
                    }
                    <br /><br /><label>VENDI</label>
                </div>
                <div class="form-group" id="linkBaratta" >
                    @if( !User.Identity.IsAuthenticated ) {
                        <a class="btn btn-warning btn-lg btn-round" data-target="#myWindow" data-toggle="modal" href="#" role="button" >
                            <span class="glyphicon glyphicon-random"></span></a>
                    } else {
                        <a class="btn btn-warning btn-lg btn-round" href="#" role="button" >
                            <span class="glyphicon glyphicon-random"></span></a>
                    }
                    <br /><br /><label>BARATTA</label>
                </div>
            </form>
        </div>


        <hr />

        <div class="container" >


            <div class="row" >

                @foreach( var annuncio in GetAnnounce() ) {
                    <div class="col-sm-4 col-md-3" >
                        <div class="col-item" >
                            <div class="photo" >
                                <img src="@GetImages( annuncio.Id )" class="img-responsive" />
                            </div>

                            <div class="info" >


                                <h5>
                                    @annuncio.Title
                                </h5>
                                @if( annuncio.Price == 0 ) {
                                    <h5 class="price-text-color" >IN REGALO</h5>
                                } else {
                                    <h5 class="price-text-color" >Prezzo: @annuncio.Price</h5>
                                }


                                <div class="price" >
                                    <br />
                                    <h5>Autore: @GetAutore( annuncio.AuthorId ).UserName</h5>
                                    <br />
                                </div>
                                <div class="separator clear-left" >
                                    @if( !User.Identity.IsAuthenticated ) {
                                        <p class="btn-add" >
                                            <i class="fa fa-shopping-cart" ></i>
                                            <a data-target="#myWindow" data-toggle="modal" href="#" >Dettagli</a>
                                        </p>
                                        <p class="btn-details" >
                                            <i class="fa fa-list" ></i><a class="" data-target="#myWindow" data-toggle="modal" href="#" >Contatta</a>
                                        </p>
                                    } else {
                                        <p class="btn-add" >
                                            <i class="fa fa-shopping-cart" ></i>
                                            <a href="~/Announces/Details/?id=@annuncio.Id" class="" >Dettagli</a>
                                        </p>
                                        <p class="btn-details" >
                                            <i class="fa fa-list" ></i><a href="~/Messages/Details/?id=@annuncio.AuthorId" class="" >Contatta</a>
                                        </p>
                                    }
                                </div>
                                <div class="clearfix" ></div>
                            </div>
                        </div>
                    </div>
                }

            </div>
        </div>


    </div>
</div>